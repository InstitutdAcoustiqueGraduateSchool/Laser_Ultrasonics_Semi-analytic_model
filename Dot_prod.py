# -*- coding: utf-8 -*-
"""
Created on Fri Dec 18 2020

Laser ultrasonics: Semi-analytical model

@author: Romain HODE
"""

import numpy as np

def dot2224(A, B):
    t00 = A[0, 0, :, :]*B[0, 0, :, :]+A[0, 1, :, :]*B[1, 0, :, :]
    t01 = A[0, 0, :, :]*B[0, 1, :, :]+A[0, 1, :, :]*B[1, 1, :, :]
    t02 = A[0, 0, :, :]*B[0, 2, :, :]+A[0, 1, :, :]*B[1, 2, :, :]
    t03 = A[0, 0, :, :]*B[0, 3, :, :]+A[0, 1, :, :]*B[1, 3, :, :]
    t10 = A[1, 0, :, :]*B[0, 0, :, :]+A[1, 1, :, :]*B[1, 0, :, :]
    t11 = A[1, 0, :, :]*B[0, 1, :, :]+A[1, 1, :, :]*B[1, 1, :, :]
    t12 = A[1, 0, :, :]*B[0, 2, :, :]+A[1, 1, :, :]*B[1, 2, :, :]
    t13 = A[1, 0, :, :]*B[0, 3, :, :]+A[1, 1, :, :]*B[1, 3, :, :]
    dotAB = np.array([[t00, t01, t02, t03], [t10, t11, t12, t13]])
    return dotAB

def dot2221(A, B): 
    t0 = A[0, 0, :, :]*B[0, 0, :, :]+A[0, 1, :, :]*B[1, 0, :, :]
    t1 = A[1, 0, :, :]*B[0, 0, :, :]+A[1, 1, :, :]*B[1, 0, :, :]
    dotAB = np.array([[t0], [t1]]) 
    return dotAB

def dot2444(A, B):
    t00 = A[0, 0, :, :]*B[0, 0, :, :]+A[0, 1, :, :]*B[1, 0, :, :]+A[0, 2, :, :]*B[2, 0, :, :]+A[0, 3, :, :]*B[3, 0, :, :]
    t01 = A[0, 0, :, :]*B[0, 1, :, :]+A[0, 1, :, :]*B[1, 1, :, :]+A[0, 2, :, :]*B[2, 1, :, :]+A[0, 3, :, :]*B[3, 1, :, :]
    t02 = A[0, 0, :, :]*B[0, 2, :, :]+A[0, 1, :, :]*B[1, 2, :, :]+A[0, 2, :, :]*B[2, 2, :, :]+A[0, 3, :, :]*B[3, 2, :, :]
    t03 = A[0, 0, :, :]*B[0, 3, :, :]+A[0, 1, :, :]*B[1, 3, :, :]+A[0, 2, :, :]*B[2, 3, :, :]+A[0, 3, :, :]*B[3, 3, :, :]
    t10 = A[1, 0, :, :]*B[0, 0, :, :]+A[1, 1, :, :]*B[1, 0, :, :]+A[1, 2, :, :]*B[2, 0, :, :]+A[1, 3, :, :]*B[3, 0, :, :]
    t11 = A[1, 0, :, :]*B[0, 1, :, :]+A[1, 1, :, :]*B[1, 1, :, :]+A[1, 2, :, :]*B[2, 1, :, :]+A[1, 3, :, :]*B[3, 1, :, :]
    t12 = A[1, 0, :, :]*B[0, 2, :, :]+A[1, 1, :, :]*B[1, 2, :, :]+A[1, 2, :, :]*B[2, 2, :, :]+A[1, 3, :, :]*B[3, 2, :, :]
    t13 = A[1, 0, :, :]*B[0, 3, :, :]+A[1, 1, :, :]*B[1, 3, :, :]+A[1, 2, :, :]*B[2, 3, :, :]+A[1, 3, :, :]*B[3, 3, :, :]
    dotAB = np.array([[t00, t01, t02, t03], [t10, t11, t12, t13]])
    return dotAB

def dot2441(A, B): 
    t0 = A[0, 0, :, :]*B[0, 0, :, :]+A[0, 1, :, :]*B[1, 0, :, :]+A[0, 2, :, :]*B[2, 0, :, :]+A[0, 3, :, :]*B[3, 0, :, :]
    t1 = A[1, 0, :, :]*B[0, 0, :, :]+A[1, 1, :, :]*B[1, 0, :, :]+A[1, 2, :, :]*B[2, 0, :, :]+A[1, 3, :, :]*B[3, 0, :, :]
    dotAB = np.array([[t0], [t1]])  
    return dotAB
    
def dot4441(A, B):
    t0 = A[0, 0, :, :]*B[0, 0, :, :]+A[0, 1, :, :]*B[1, 0, :, :]+A[0, 2, :, :]*B[2, 0, :, :]+A[0, 3, :, :]*B[3, 0, :, :]
    t1 = A[1, 0, :, :]*B[0, 0, :, :]+A[1, 1, :, :]*B[1, 0, :, :]+A[1, 2, :, :]*B[2, 0, :, :]+A[1, 3, :, :]*B[3, 0, :, :]
    t2 = A[2, 0, :, :]*B[0, 0, :, :]+A[2, 1, :, :]*B[1, 0, :, :]+A[2, 2, :, :]*B[2, 0, :, :]+A[2, 3, :, :]*B[3, 0, :, :]
    t3 = A[3, 0, :, :]*B[0, 0, :, :]+A[3, 1, :, :]*B[1, 0, :, :]+A[3, 2, :, :]*B[2, 0, :, :]+A[3, 3, :, :]*B[3, 0, :, :]
    dotAB = np.array([[t0], [t1], [t2], [t3]])    
    return dotAB

def dot4444(A, B):
    t00 = A[0, 0, :, :]*B[0, 0, :, :]+A[0, 1, :, :]*B[1, 0, :, :]+A[0, 2, :, :]*B[2, 0, :, :]+A[0, 3, :, :]*B[3, 0, :, :]
    t01 = A[0, 0, :, :]*B[0, 1, :, :]+A[0, 1, :, :]*B[1, 1, :, :]+A[0, 2, :, :]*B[2, 1, :, :]+A[0, 3, :, :]*B[3, 1, :, :]
    t02 = A[0, 0, :, :]*B[0, 2, :, :]+A[0, 1, :, :]*B[1, 2, :, :]+A[0, 2, :, :]*B[2, 2, :, :]+A[0, 3, :, :]*B[3, 2, :, :]
    t03 = A[0, 0, :, :]*B[0, 3, :, :]+A[0, 1, :, :]*B[1, 3, :, :]+A[0, 2, :, :]*B[2, 3, :, :]+A[0, 3, :, :]*B[3, 3, :, :]
    
    t10 = A[1, 0, :, :]*B[0, 0, :, :]+A[1, 1, :, :]*B[1, 0, :, :]+A[1, 2, :, :]*B[2, 0, :, :]+A[1, 3, :, :]*B[3, 0, :, :]
    t11 = A[1, 0, :, :]*B[0, 1, :, :]+A[1, 1, :, :]*B[1, 1, :, :]+A[1, 2, :, :]*B[2, 1, :, :]+A[1, 3, :, :]*B[3, 1, :, :]
    t12 = A[1, 0, :, :]*B[0, 2, :, :]+A[1, 1, :, :]*B[1, 2, :, :]+A[1, 2, :, :]*B[2, 2, :, :]+A[1, 3, :, :]*B[3, 2, :, :]
    t13 = A[1, 0, :, :]*B[0, 3, :, :]+A[1, 1, :, :]*B[1, 3, :, :]+A[1, 2, :, :]*B[2, 3, :, :]+A[1, 3, :, :]*B[3, 3, :, :]
    
    t20 = A[2, 0, :, :]*B[0, 0, :, :]+A[2, 1, :, :]*B[1, 0, :, :]+A[2, 2, :, :]*B[2, 0, :, :]+A[2, 3, :, :]*B[3, 0, :, :]
    t21 = A[2, 0, :, :]*B[0, 1, :, :]+A[2, 1, :, :]*B[1, 1, :, :]+A[2, 2, :, :]*B[2, 1, :, :]+A[2, 3, :, :]*B[3, 1, :, :]
    t22 = A[2, 0, :, :]*B[0, 2, :, :]+A[2, 1, :, :]*B[1, 2, :, :]+A[2, 2, :, :]*B[2, 2, :, :]+A[2, 3, :, :]*B[3, 2, :, :]
    t23 = A[2, 0, :, :]*B[0, 3, :, :]+A[2, 1, :, :]*B[1, 3, :, :]+A[2, 2, :, :]*B[2, 3, :, :]+A[2, 3, :, :]*B[3, 3, :, :]   
    
    t30 = A[3, 0, :, :]*B[0, 0, :, :]+A[3, 1, :, :]*B[1, 0, :, :]+A[3, 2, :, :]*B[2, 0, :, :]+A[3, 3, :, :]*B[3, 0, :, :]
    t31 = A[3, 0, :, :]*B[0, 1, :, :]+A[3, 1, :, :]*B[1, 1, :, :]+A[3, 2, :, :]*B[2, 1, :, :]+A[3, 3, :, :]*B[3, 1, :, :]
    t32 = A[3, 0, :, :]*B[0, 2, :, :]+A[3, 1, :, :]*B[1, 2, :, :]+A[3, 2, :, :]*B[2, 2, :, :]+A[3, 3, :, :]*B[3, 2, :, :]
    t33 = A[3, 0, :, :]*B[0, 3, :, :]+A[3, 1, :, :]*B[1, 3, :, :]+A[3, 2, :, :]*B[2, 3, :, :]+A[3, 3, :, :]*B[3, 3, :, :]   
      
    dotAB = np.array([[t00, t01, t02, t03], [t10, t11, t12, t13], [t20, t21, t22, t23], [t30, t31, t32, t33]])
    return dotAB